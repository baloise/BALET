$(document).ready(function(){$(".clickandload").each(function(){$(this).click(function(g){$(".timetableContent").slideDown("slow");var f=$(this);$("#tafel_content").empty();$("#meldung").remove();g.preventDefault();var b=new Date();var e=b.getDate()+"-"+(b.getMonth()+1)+"-"+b.getFullYear();var a=moment(e,"DD-MM-YYYY").week();var c=a+"-"+b.getFullYear();$("#weekchangerDateNum").html(c);function d(j){var i=$(j).attr("classId");if(!i){i=$("#k_auswahl").attr("value")}var h=["So","Mo","Di","Mi","Do","Fr","Sa"];if(i>=0&&i!==""){$.getJSON("http://sandbox.gibm.ch/tafel.php?klasse_id="+i+"&woche="+c,function(k){if(k!=""){$.each(k,function(l,n){var m='<tr><td class="agenda-date" class="active" rowspan="1"> <div class="dayofmonth">'+h[n.tafel_wochentag]+'</div><div class="dayofweek"></div><div class="shortdate text-muted">'+n.tafel_datum+'</div></td><td class="agenda-time"> '+n.tafel_von+" - "+n.tafel_bis+' </td><td class="agenda-events"><div class="agenda-event">'+n.tafel_longfach+'</div></td><td class="agenda-events"><div class="agenda-event">'+n.tafel_raum+'</div></td><td class="agenda-events"><div class="agenda-event">'+n.tafel_lehrer+"</div></td></tr>";$("#tafel_content").append(m);$("#k_auswahl").val(i);$("#kalender_tafel").fadeTo("fast",1)})}else{$("#kalender_tafel").fadeTo("fast",0);$("#kalender_tafel").after('<p id="meldung">'+translate[167]+"?</p>")}}).fail(function(k,m,l){alert(translate[157]+": "+m)})}}d(f);$(".weekchangerNext").on("click",function(){$("#tafel_content").empty();$("#meldung").remove();var i=$("#weekchangerDateNum").html();var j=i.split("-")[0];if(j=="52"){var h=parseInt(i.split("-")[1])+1;i="1-"+h}else{j=parseInt(j)+1;i=j+"-"+i.split("-")[1]}$("#weekchangerDateNum").html(i);c=i;d(f)});$(".weekchangerBefore").on("click",function(){$("#tafel_content").empty();$("#meldung").remove();var i=$("#weekchangerDateNum").html();var j=i.split("-")[0];if(j=="1"){var h=parseInt(i.split("-")[1])-1;i="52-"+h}else{j=parseInt(j)-1;i=j+"-"+i.split("-")[1]}$("#weekchangerDateNum").html(i);c=i;d(f)})})})});